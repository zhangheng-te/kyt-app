<!DOCTYPE html>
  <html>
  <head>
      <meta charset="utf-8">
      <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
      <title>院校指南</title>
      <link rel="stylesheet" type="text/css" href="../css/api.css"/>
      <link rel="stylesheet" type="text/css" href="../css/aui.css">
      <link rel="stylesheet" type="text/css" href="../css/common.css"/>
      <link rel="stylesheet" type="text/css" href="../css/add.css"/>
      <link rel="stylesheet" type="text/css" href="../css/school_guide.css"/>
      <style>

          body{

          }
          #wrap2 #header{
            background-image: linear-gradient(to right, #5bbbff, #289bff);
            height: 11.733vw;
            width: 100%;
            position: fixed;
            top:0;
            left: 0;
          }

         #wrap2 #header .sousuo {
           float: left;
           margin:2.933vw 0 0 6vw;
            width: 77.6vw;
            height: 6.133vw;
            background-color: #afdbff;
            border-radius: 3.333vw;
            text-align: center;
            position: relative;
          }

          #wrap2   #aaaaaaaaaa {
            width: 100%;
            height: 6.133vw;
            text-align: center;
            font-size: 3.467vw;
            line-height:  6.133vw;
            outline:none;
         
          }


          #wrap2    #aaaaaaaaaa::-webkit-input-placeholder {
            color: #fff;
          }

          #wrap2 #header  img{
            position: absolute;
            top: 1.333vw;
            right: 3.333vw;
            width: 3.467vw;
            height: 3.333vw;
            
          }

          #wrap2 .btn {
            position: absolute;
            right:6.133vw ;
            font-size: 3.467vw;
          
            
          }

          #main {
            background-image: linear-gradient(to right, #5bbbff, #289bff); 
            overflow: hidden;
          }

          #main .connent {
            margin-top: 11.733vw;
            width: 100%;
            height: 100%;
            border-radius: 3.333vw  3.333vw 0 0;
            background-color: #fff;
            overflow: hidden;
          }

          /* #wrap2 .aui-pull-right span {
             font-size: 3.467vw;
            color: #fff;
          }
          #header .aui-title{
            color: #000;
          }
          #header .aui-icon-left{
            color: #000
          } */
          .menu_navs{
            display: flex;
            position: relative;
            height: 9.067vw;
            font-size: 3.2vw;
            padding:3.467vw  4.667vw  0;
            border: 0;
            box-sizing: border-box;

          }
          .menu_navs select {
            width: 100%;
            text-align: center;
          }

          .school_img img{
            width: 100%;
            height: 100%;
          }
          .menu_nav select{
            font-size:3vw;
          }
          .menu_nav{
            width: 100%;
            flex: 1;
            text-align: center;
          }

          .down {
         background: url( ../image/iconimg/xia.png) no-repeat;
         background-size: 100%;
         float: left;
          }
          .mask{
            width:100%;
            height:100%;
            position:fixed;
            top:0;
            left:0;
            background:#000;
            opacity:0.4;
            overflow:hidden;
            z-index:98;
            color:#fff;
          }
          .mask_grop_show{
            width: 50vw;

            top: 50%;

            background-color: #fff;
            left: 50%;
            transform:translateY(-50%);
            margin-left: -25vw;
            overflow-y:scroll;
            border-radius: 4px;
            position: fixed;
            z-index: 99;
          }
          .menu_typeitem{
            display: flex;
            padding: 2vw;
            justify-content: space-between;
            align-items: center;
          }
          .menu_type_bat{
            text-align:center;font-size: 3.5vw;
            background-color: #1f8dfe;
            padding: 1vw 2vw;
            width: 10vw;
            border-radius: 4px;
            color: #fff;
            margin: 2vw 0;
          }
         
          .aui-searchbar-input input::-webkit-input-placeholder {
      			color: #666;  }
        
          #search-input::-webkit-input-placeholder { /* WebKit browsers 适配谷歌 */
              color: #979ba6;
          }
          #search-input:-moz-placeholder { /* Mozilla Firefox 4 to 18 适配火狐 */
              color: #979ba6;
          }
          #search-input::-moz-placeholder { /* Mozilla Firefox 19+ 适配火狐 */
              color: #979ba6;
          }
          #search-input:-ms-input-placeholder { /* Internet Explorer 10+  适配ie*/
              color: #979ba6;
          }
      </style>
  </head>
  <body>
    <div id='wrap2'>
      <!-- 头部搜索框 -->
      <header id="header" class="aui-bar aui-bar-nav" v-cloak>
  			<div class="sousuo" >
  			
    						<input id="aaaaaaaaaa" @focus='inoutFocus' type="search" v-model="keyword" placeholder="请输入搜索内容" id="search-input">
              <img src="../image/iconimg/sousuo.png.png" alt="">
  				
  			</div>
  			<div v-if="!search" class="btn"  @click='searchConfirm()'>
  				<span>搜索</span>
  			</div>
        <div v-if="search" class="btn"   @click='cancelSearch()'>
  				<span>取消</span>
  			</div>
      </header>
      <!-- 内容区域 -->
      <div id="main" class="main" v-cloak>
        <div class="connent">
          <!-- 导航栏 -->
          <div class="menu_navs"   v-cloak>
            <div class="menu_nav">
    
              <select v-model='TabFengl.provinceid' @change='changeschool(-1,1)'>
                  <option v-for='item in TabFengl.province' v-bind:disabled="item.disabled" v-bind:value="item.id">{{item.name}}</option>
              </select>
              <div class="down" style="width: 1.733vw;height: 0.933vw;margin-left: 1.867vw;"></div>
            </div>
            <div class="menu_nav">
              <select v-model='TabFengl.cityid' @change='changeschool(-1)'>
                  <option v-for='item in TabFengl.city' v-bind:disabled="item.disabled" v-bind:value="item.area_id">{{item.area_name}}</option>
                  <option :value="TabFengl.cityid" disabled='true' v-if="TabFengl.city.length==0">城市</option>
              </select>
              <div class="down" style="width: 1.733vw;height: 0.933vw;margin-left: 1.867vw;"></div>
            </div>
            <div class="menu_nav">
              <!-- <select v-model='TabFengl.Typeid' @change='changeschool(-1)'>
                  <option v-for='item in TabFengl.Type' v-bind:disabled="item.disabled" v-bind:value="item.value">{{item.name}}</option>
              </select> -->
              <div @click.stop='is_type=true' style="width: 100%;font-size: 3vw;">性质</div>
    
              <div class="down" style="width: 1.733vw;height: 0.933vw;margin-left: 1.867vw;">
              </div>
            </div>
            <div class="menu_nav">
                <!-- <select v-model='TabFengl.Typeid' @change='changeschool(-1)'>
                    <option v-for='item in TabFengl.Type' v-bind:disabled="item.disabled" v-bind:value="item.value">{{item.name}}</option>
                </select> -->
                <div @click.stop='is_zy=true' style="width: 100%;font-size: 3vw;">专业</div>
    
                <div class="down" style="width: 1.733vw;height: 0.933vw;margin-left: 1.867vw;"></div>
              </div>
          </div>
          <div class="mask" :style="is_type||is_zy?'display:block':'display:none'" @click='is_type=false;is_zy=false'></div>
          <div class="mask_grop_show" :style="is_type?'display:block':'display:none'" v-cloak>
            <div v-for='item in TabFengl.Type' class="menu_typeitem"><h4>{{item.name}}</h4><input  v-model='TabFengl.Typeid' :value="item.value" type="checkbox"></div>
            <div class="fcc">
              <div class="menu_type_bat" style="margin-right:4vw;" @click='is_type=false;is_zy=false'>取消</div>
              <div class="menu_type_bat" @click='changeschool(-1)'>确定</div>
            </div>
          </div>
          <div class="mask_grop_show" :style="is_zy?'display:block':'display:none'" v-cloak>
              <div v-for='item in TabFengl.Type_zy' class="menu_typeitem"><h4>{{item.name}}</h4><input  v-model='TabFengl.Type_zyid' :value="item.value" type="checkbox"></div>
              <div class="fcc">
                <div class="menu_type_bat" style="margin-right:4vw;" @click='is_type=false;is_zy=false'>取消</div>
                <div class="menu_type_bat" @click='changeschool(-1)'>确定</div>
              </div>
          </div>
          <p style="text-align:center;color:rgb(15, 15, 15);font-size:4vw;" v-if='schooldata&&schooldata.length==0'>暂无数据</p>
          <!-- 院校 -->
          <div class="school_area" v-for="item,index in schooldata" @click='navschoolDetails(index)' v-cloak>
            <div class="school_img" style="width: 24vw;height: 24vw;"><img :src="item.school_logo_text || item.school_picture_text" alt=""></div>
            <div class="school_right"  style="padding:0">
              <!-- 院校名称 -->
              <div class="school_line1 f_row_sb">
                <div style="font-size:3.467vw; text-overflow: ellipsis; overflow: hidden; white-space: nowrap; width: 70%;font-weight: 600;margin-bottom: 4.067vw;padding:0">{{item.school_name}}</div>
                
              </div>
              <!-- 信息是否在职 -->
              <div class="school">
                <div class="line2 " v-for="items in item.school_system_text">  
                  {{items}}
                </div>
                {{item.major}}
              </div>
              <!-- 性质 -->
         
              <div class="xingzhi" >
                <div class="list  "  v-for='titem in item.school_type_text' v-if="titem != '其他'">{{titem}}</div>
                <div class="list"   v-for='titem in item.school_type_text' v-if="titem == '其他'">{{titem}}</div>
              </div>
              <!-- 地区 -->
              <div style="font-size:2.667vw;color:#666666;float: left;position: relative;"><p style="padding-right: 1.333vw;font-size: 2.667vw;color: #9b9b9b;">{{item.school_area_text}}</p> <img src="../image/iconimg/you.png" alt="" style="float: right;width: 0.933vw;height: 1.733vw;position: absolute;top: 50%;transform: translateY(-50%);right: 0;"> </div>
            </div>
          </div>
              <p style="text-align:center;color:#666;font-size:4vw;" v-if='schooldata&&schooldata.length!=0'>已经到底了~</p>
        </div>
        </div>
    
    </div>
  </body>
  <script type="text/javascript" src="../script/api.js"></script>
  <script src="../script/jquery.min.js"></script>
  <script type="text/javascript" src="../script/vue.js"></script>
  <script src="../script/configUtil.js" charset="utf-8"></script>
  <script type="text/javascript">
  setTimeout(function () {
    if (typeof api == 'undefined') {
        api = {
            pageParam: {}
        }
        apiready();
    }
}, 500);
      apiready = function(){
        api.setStatusBarStyle({
            style: 'dark',
        })
        var header = document.querySelector('#header');
        var main = document.querySelector('#main');
        $api.fixStatusBar(header);
        $api.fixStatusBar(main);
        var vm = new Vue({
          el: "#wrap2",
          data: {
            navs:['省份','市','性质'],
            TabFengl:{
              provinceid:'',
              city:[],
              cityid:'',
              Systemid:'',
              Typeid:[],
              province:[],
              System:[],
              Type:[],
              Type_zy:[],
              Type_zyid:[],
              page:1,

            },
            schooldata:[],
            is_type:false,
            is_zy:false,
            keyword:'',
            keyword_c:'',
            search:false
          },
          mounted: function () {
            var that = this;
            this.bindprovinceFl();
            this.bindSystemFl();
            this.bindTypeFl();
            this.bindType_zy()
            this.changeschool();
            this.scrolltobottom()
            // document.getElementById('search_from').onsubmit = function(){
            //   //that.confirm(null);
            //   that.searchConfirm();
            //   // document.activeElement.blur();
            // };
            $(window).on('scroll',function(){
              var input = document.getElementById("aaaaaaaaaa");
              input.blur();
            })
          },
          methods: {
            inoutFocus(){
              //document.querySelector('#header').scrollIntoView(true);
            },
            cancelSearch(){
              this.schooldata = [];
              this.search = false;
              this.keyword = '';
              this.keyword_c = '';
              this.changeschool();
            },
            searchConfirm(){
              this.schooldata = [];
              this.search = true;
              this.keyword_c = this.keyword;
              this.changeschool(-1,null,this.keyword);
              
            },
            //上拉
            scrolltobottom() {
              var that =this;
                api.addEventListener({
                    name: 'scrolltobottom',
                    extra: {
                        threshold: 50 //距离底部距离
                    }
                }, function(ret, err) {
                    // listAjax(true);
                    that.TabFengl.page =that.TabFengl.page+1;
                    that.changeschool()
                });
            },
            //关闭
            closew(){
              this.closeW()

            },

            //详情
            navschoolDetails(index){
              var that =this;
              var data ={
                    school_id:that.schooldata[index].school_id
              }
              that.openW('find_school_details',data,true);
            },
            //学院list
            changeschool(id,type,keyword){
              var that =this;
              this.is_type=false
              this.is_zy=false
              if(id==-1){
                that.schooldata=[]
                that.TabFengl.page =1
              }
              if(type){
                if(that.TabFengl.provinceid!=0){
                  that.bindcityFl()
                }else{
                  that.TabFengl.cityid =-1
                  that.TabFengl.city=[]
                }
              }
              console.log(JSON.stringify(that.TabFengl.Type_zyid))
              var data ={
                school_area:that.TabFengl.provinceid==-1?'':that.TabFengl.provinceid,
                school_system:that.TabFengl.Systemid==-1?'':that.TabFengl.Systemid,
                school_type:that.TabFengl.Typeid.length==0?'':that.TabFengl.Typeid,
                school_city:that.TabFengl.cityid==-1?'':that.TabFengl.cityid,
                school_zy:that.TabFengl.Type_zyid.length==0?'':that.TabFengl.Type_zyid,
                page:that.TabFengl.page,
                limit:10
              }
              if(this.search){
                data.keyword = this.keyword_c;
              }
              that.ajaxpost_noloading('post',globalData.schoolList,data).then((res)=>{
                var res =$.parseJSON(res);
                // alert(JSON.stringify(res))
                if(!res.data.data){
                  return
                }
                that.schooldata=that.schooldata.concat(res.data.data)
                // that.bindlist(0);
              }).catch((ret)=>{
                loginfo(ret)
              })
            },
            //省份
            bindprovinceFl(){
              var that =this;
              var data ={
                school:1
              }

              that.ajaxpost('post',globalData.provinceList,data).then((res)=>{
                var res =$.parseJSON(res);
                var whole={
                  name:'全国',
                  disabled:false,
                  id:'0'
                }
                res.data.unshift(whole);
                that.TabFengl.province=res.data
                that.TabFengl.provinceid='0';
                // that.bindlist(0);

              }).catch((ret)=>{
                loginfo(ret)
              })
            },
            //市份
            bindcityFl(status){
              var that =this;
              var data ={
                province:that.TabFengl.provinceid
              }
              that.ajaxpost('post',globalData.area,data).then((res)=>{
                var res =$.parseJSON(res);
                var whole={
                  area_name:'全部',
                  disabled:false,
                  id:'0'
                }

                res.data.unshift(whole);
                // res.data.unshift(whole);
                that.TabFengl.city=res.data

                that.TabFengl.cityid='0';

                // that.bindlist(0);

              }).catch((ret)=>{
                loginfo(ret)
              })
            },
            //学制
            bindSystemFl(){
              var that =this;
              var data ={
                school:1
              }
              that.ajaxpost('post',globalData.schoolSystem,data).then((res)=>{
                var res =$.parseJSON(res);
                var whole={
                  name:'学制',
                  disabled:true,
                  value:'-1'
                }

                res.data.unshift(whole);
                that.TabFengl.System=res.data
                that.TabFengl.Systemid='-1';
                // that.bindlist(0);
              }).catch((ret)=>{
                loginfo(ret)
              })
            },
            //性质
            bindTypeFl(){
              var that =this;
              var data ={
                school:1
              }
              that.ajaxpost('post',globalData.schoolType,data).then((res)=>{

                var res =$.parseJSON(res);


                that.TabFengl.Type=res.data

                // that.bindlist(0);s
              }).catch((ret)=>{
                loginfo(ret)
              })
            },
             //专业
             bindType_zy(){
              var that =this;
              var data ={

              }
              that.ajaxpost('post',globalData.school_zy,data).then((res)=>{

                var res =$.parseJSON(res);



                that.TabFengl.Type_zy=res.data

                // that.bindlist(0);s
              }).catch((ret)=>{
                loginfo(ret)
              })
            },
          }
        });
      };
  </script>
  </html>
